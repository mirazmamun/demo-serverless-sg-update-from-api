# Serverless Service for Security Group (SG) Update from API source like Github
This microservice allows automatic update of SG rules using the IP addresses from a specified API endpiont.

## How to Deploy

There are two ways you can provision the stack. First one uses built CF template and second one compiles a template from source (preferred):

* If you just want to try out built version(not preferred), use the files under `samples` folder and do the following:
1. Create the stack using CF Template. First use `cloudformation-template-create-stack.json` to create the stack to create the S3 bucket. As the templates are autogenerated by script, you need to put the source package in the defined location shown by location in `cloudformation-template-update-stack.json`:
```
    "UpdateLambdaFunction": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "ServerlessDeploymentBucket"
          },
          "S3Key": "serverless/update-from-github/dev/1547984183598-2019-01-20T11:36:23.598Z/update-from-github.zip"
        },
```
2. Then use the stack `cloudformation-template-update-stack.json` to create rest of the resources.

* You need `nodejs > 8.0.0` and `npm > 5.0.0` installed. Follow these steps to do it using build tools:

1. Run ```npm install```
2. Make sure you have setup your AWS credentials that will have privilege to create the resources required by CF Template. Checkout the docs [here](https://serverless.com/framework/docs/providers/aws/guide/credentials#using-aws-access-keys)
3. The default setup will take care of linking executable in POSIX environment. Alternatively you can install `serverless` globally. `npm install -g serverless` or checkout [this link](https://serverless.com/framework/docs/providers/aws/guide/quick-start#pre-requisites)
4. Run ```./node_modules/.bin/serverless deploy``` or is `serverless` is globally available in you environment, run ```serverless deploy```. This command will create the CF template locally and will create the CF stack in the target region. If you want to take the CF template yourself then modify and run it try ```serverless package --package <target folder to create packages to>```. Try the [docs](https://serverless.com/framework/docs/providers/aws/guide/packaging/) to learn more.